NAME	MYPROJECT

DATA	SEGMENT
	BEGIN0		DB	'PLEASE INPUT 10 NUMBERS:',0DH,0AH,'$'
	ERROR0		DB	'ERROR! ILLEGAL NUMBER!',0DH,0AH,'$'
	ENTER0		DB	0DH,0AH,'$'
	MAXNUM		DB	'MAX NUMBER :',0DH,0AH,'$'
	OUTPUT1		DB	'ORIGIN:',0DH,0AH,'$'
	OUTPUT2		DB	'FINAL:',0DH,0AH,'$'
	ORG		1000H
	TENNUM		DB	10 DUP(?)			;最终存放的地方
DATA	ENDS


STACK	SEGMENT		PARA	STACK
	DB	100 DUP(?)
STACK	ENDS


DISPLAY	MACRO	STRING		;宏定义输出显示
	LEA	DX,STRING
	MOV	AH,09		;AH=09时，INT 21H表示显示，以'$'结束
	INT	21H
ENDM


CODE	SEGMENT
	ASSUME	CS:CODE,DS:DATA,ES:DATA,SS:STACK

START:	MOV	AX,DATA		;ASSUME只是说明关系，需手动继续赋予初值
        MOV     DS,AX
        MOV     ES,AX
        MOV     AX,STACK
        MOV     SS,AX
        LEA     SI,TENNUM
        MOV     CX,10
        DISPLAY    BEGIN0	;打印开始的命令

INPUT:  MOV	AH,1		;键盘输入并回显，同时输入的结果直接放进AL
	INT	21H
	CALL	JUDGE
	MOV	[SI],AL		;存储到放十个数区域
 	INT	21H		;继续输入
	CMP	AL,0DH		;检测是不是回车
	JZ 	NEXT		;是的话跳转到NEXT
	CALL	JUDGE
	PUSH 	CX
	MOV	CL,4
	ROL 	BYTE PTR [SI],CL
	OR	[SI],AL
	POP 	CX
	INT	21H
	CMP 	AL,0DH
	JZ 	NEXT
	JMP 	BEGIN

NEXT:	INC	SI
	LOOP	INPUT		;循环输入
	DISPLAY	OUTPUT1		;输出输入的10个数
	CALL	DISPLA
	JMP	SORT

ERROR:  DISPLAY	ERROR0    ;提示出错，需重新输入
	JMP	INPUT

BEGIN:  DISPLAY	BEGIN0    ;提示出错，需重新输入
	JMP	INPUT

SORT:	MOV	CX,9        ;冒泡排序
EXTERN:	PUSH	CX          
	LEA	DI,TENNUM

INTER:  MOV	BL,[DI]
	INC	DI
	CMP	BL,[DI]
 	JB	CHANGE
	DEC	CX
	JNZ	INTER
	JMP	FINISH

CHANGE:	XCHG	BL,[DI]
 	DEC	DI
	MOV	[DI],BL
	INC	DI
	DEC	CX
	JNZ	INTER

FINISH: POP	CX
	DEC	CX
	JNZ	EXTERN

	DISPLAY	MAXNUM		;显示最大数

	LEA	SI,TENNUM
	MOV 	DL,[SI]
	MOV	CL,4
	SHR  	DL,CL
	OR 	DL,DL
 	JZ 	DISP
 	ADD 	DL,30H
	MOV 	AH,02
	INT	21H

DISP: 	MOV	DL,[SI]		
	AND	DL,0FH
	ADD 	DL,30H
	MOV 	AH,02
	INT 	21H
	DISPLAY 	ENTER0
              
	DISPLAY	OUTPUT2			;输出排序完成后的10个数
	CALL 	DISPLA
	MOV	AH,4CH
	INT	21H
       
JUDGE	PROC 	NEAR			;判断是否符合要求
	CMP	AL,'9'
	JA	ERROR
	CMP	AL,'0'
	JB 	ERROR
	AND	AL,0FH
	RET
JUDGE	ENDP

DISPLA  PROC	NEAR			;输出地址连续的10个数
	MOV	CX,10
	LEA	SI,TENNUM
LOOP1:  MOV	DL,[SI]
	PUSH	CX
	MOV	CL,4
	SHR	DL,CL
	OR	DL,DL
	JZ	DISP1
	ADD	DL,30H
	MOV	AH,02
	INT	21H

DISP1:  MOV	DL,[SI]     ;输出排序数
	AND	DL,0FH
	ADD	DL,30H
	MOV	AH,02
	INT	21H
	DISPLAY	ENTER0
	INC	SI
	POP	CX
	LOOP	LOOP1
	RET
DISPLA  ENDP
              
CODE	ENDS
END	START
